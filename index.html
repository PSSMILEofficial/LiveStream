<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Live Chat System</title>
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
    body {
        font-family: Arial; background: #111; color: #fff; padding: 10px;
    }
    #messages {
        height: 350px; 
        overflow-y: auto; 
        background: #000; 
        padding: 10px; 
        border-radius: 5px; 
        border: 1px solid #333;
    }
    #msgInput, #nameInput {
        width: 40%;
        padding: 10px;
        border-radius: 5px;
        border: none;
        margin-top: 5px;
    }
    button {
        padding: 10px 15px;
        background: #ff4444;
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
</style>
</head>

<body>

<h2>LIVE CHAT SYSTEM</h2>

<div id="messages"></div>

<br>

<input id="nameInput" placeholder="Enter Name">
<input id="msgInput" placeholder="Enter Message">
<button onclick="sendMessage()">Send</button>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>

<script>
    // YOUR FIREBASE CONFIG â€” REPLACE
    const firebaseConfig = {
        apiKey: "YOUR_API_KEY",
        authDomain: "YOUR_PROJECT.firebaseapp.com",
        databaseURL: "https://YOUR_PROJECT.firebaseio.com",
        projectId: "YOUR_PROJECT",
        storageBucket: "YOUR_PROJECT.appspot.com",
        messagingSenderId: "000000",
        appId: "1:0000:web:0000"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Assign viewer name
    let storedName = localStorage.getItem("viewerName");
    if (!storedName) {
        storedName = "Viewer" + Math.floor(Math.random() * 9999);
        localStorage.setItem("viewerName", storedName);
    }
    document.getElementById("nameInput").value = storedName;

    // Assign color
    let userColor;
    if (storedName.toLowerCase() === "admin") {
        userColor = "red"; // admin fixed red
    } else {
        userColor = "#" + Math.floor(Math.random() * 16777215).toString(16);
    }

    // Send chat message
    function sendMessage() {
        let name = document.getElementById("nameInput").value.trim();
        let msg = document.getElementById("msgInput").value.trim();

        if (name === "" || msg === "") return;

        localStorage.setItem("viewerName", name);

        db.ref("messages").push({
            name: name,
            text: msg,
            color: (name.toLowerCase() === "admin") ? "red" : userColor,
            system: false
        });

        document.getElementById("msgInput").value = "";
    }

    // Send system message (auto time)
    function systemMessage(text) {
        const time = new Date();
        const hh = String(time.getHours()).padStart(2, '0');
        const mm = String(time.getMinutes()).padStart(2, '0');
        const fullTime = `${hh}:${mm}`;

        db.ref("messages").push({
            name: "SYSTEM",
            text: text,
            time: fullTime,
            system: true
        });
    }

    // Display chat
    db.ref("messages").on("child_added", snap => {
        const msg = snap.val();
        const box = document.getElementById("messages");

        let el = document.createElement("div");

        if (msg.system) {
            // System message with time
            el.innerHTML =
                `<span style="color:lime;">[${msg.time}] SYSTEM: ${msg.text}</span>`;
        } else {
            // Normal chat (NO TIME)
            el.innerHTML =
                `<b style="color:${msg.color};">${msg.name}</b>: <span>${msg.text}</span>`;
        }

        box.appendChild(el);
        box.scrollTop = box.scrollHeight;
    });

    // Example system message on load
    systemMessage("User connected");
</script>

</body>
</html>
